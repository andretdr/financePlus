{% extends "layout.html" %}

{% block title %}
    Index Page
{% endblock %}

{% block body %}
<main class="page-format page-format--main" id="indexbody">
    <section class="index-body">

        <div class="index-body__heading">
            <div class="index-body__regularhead">
                <h2>My Holdings</h2>
                <div class="market__status" id="holdings__market"></div>
            </div>
            <div class="index-body__errorhead" id="index-body__errorhead" style="display: none">
                <div>*Yahoo API appears to be dropping data. Today's data may not be accurate</div>
            </div>
        </div>

        <div class="index-body__holdings" id="index-body__grid-insert" style='visibility:hidden'>
        </div>

        <div class="index-body__summary"  id="index-body__summary-insert" style='visibility:hidden'>
        </div>

    </section>
</main>
{% endblock %}

{% block footer %}
    <section class="footer-bar">

        <!-- 
        <div id="footer-bar__info"></div>
        -->
    </section>

    <input type="hidden" id="datadump" name="datadump" value="{{ data }}">
{% endblock %}

{% block script %}
<script>

    const controller = new indexController();
    const view = new indexView(controller);
    // show the elements only now so they dont pop as much
    document.getElementById("index-body__grid-insert").style.visibility = "visible";
    document.getElementById("index-body__summary-insert").style.visibility = "visible";

    view.renderMarketStatus();
    view.refreshHoldingsPage();
    view.updateAPICorrectness();

//    view.timedRefresh();

</script>
{% endblock %}
